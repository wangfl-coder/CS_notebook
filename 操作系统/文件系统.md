# 总体介绍

## 基本概念

- 文件系统和文件
  - 文件系统：一种用于持久性存储（硬盘、断电不会丢失的存储介质）的系统抽象
    - 功能作用：存在于存储器上，用于组织、控制、导航、访问和检索数据。
    - 个人电脑、手机、平板等等都有文件系统，针对不同存储介质可以又不同的文件系统。
  - 文件：文件系统中一个单元数据在操作系统的抽象。
    - 文件属性（信息）：名称、大小、位置、创建者、创建时间。。。等等。
    - 文件头（文件块）：保存文件的元数据信息，比如文件属性。
- 文件描述符
  - 文件描述符：打开的文件的标识
  - 文件使用模式：使用文件前必须先打开文件，open模式，使用完文件就要关闭文件，close模式。
  - 内核跟踪每个进程打开的文件
    - 操作系统为每个进程维护一个打开文件表，这个表用来记录打开文件的元数据信息
    - 文件描述符就是打开文件表里的索引，标识哪个打开的文件
    - ![image-20210527155235184](https://i.loli.net/2021/05/27/NWF4DIvzKA5tbof.png)
  - 打开文件表维护的打开文件状态和信息
    - 文件指针：最后一次读写位置；每个进程维护自己的文件指针。
    - 文件打开计数：当前文件被打开的次数；最后一个进程关闭文件，将此打开文件表删除该文件。
    - 文件的磁盘位置：缓存数据访问信息，方便下次读写时直接从缓存读写需要的数据
    - 访问权限：每个进程的文件访问方式，比如只读、可读可写等等。
- 目录
  - 分层文件系统
    - 文件以目录的方式组织起来
    - 目录是一类特殊的文件：目录的内容是文件索引表<文件名，指向文件的指针>
    - 目录和文件形成一种树结构，早期的文件系统是扁平的，只有一层目录。
  - 目录典型操作
    - 搜索文件、删除文件等等。
  - 操作系统只允许内核对目录进行操作，用户必须通过系统调用对目录进行操作
- 文件别名
  - 两个或多个文件名关联同一个文件
    - 实现方式：硬链接和软链接
- 文件系统种类
  - 磁盘文件系统：比如FAT、NTFS等
  - 数据库文件系统：WinFS
  - 日志文件系统：
  - 网络/分布式文件系统

## 虚拟文件系统（VFS）



## 数据块缓存

## 打开文件的数据结构

## 文件分配

## 空闲空间列表